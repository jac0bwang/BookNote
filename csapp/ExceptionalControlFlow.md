Exceptional Control Flow -- ECF 异常控制流

理解 ECF 可以帮助:
1. 理解重要的系统概念
2. 理解应用程序是如何与操作系统交换
	应用程序通过 一个叫做： 陷阱(trap)/ 系统调用(system call) 的 ECF 形式	
3. 理解并发
4. 理解异常如何工作

一. 异常 -- 控制流的突变
====================
异常表 (exception table)
异常处理程序(exception handler)

1. 异常处理

2. 异常类别
中断(interrupt)， 陷阱(trap)， 故障(fault)， 终止(abort)
- 中断(interrupt) 异步
	其他异常是同步的， 是执行当前指令的结果，这类指令叫做 故障指令 (faulting instruction)
- 陷阱和系统调用
	
- 故障
	一个经典的故障示例是缺页异常
- 终止
	是不可恢复的致命错误造成的

Linux 故障和终止
- 除法错误
	Linux 外壳通常把除法错误报告给 “浮点异常” (Floating exception)
- 一般保护故障
- 缺页(异常 14)
- 机器检查

Linux 系统调用
	系统调用通过一个 int n 陷阱指令提供

二. 进程
=======
1. 逻辑控制流
	异常处理程序，进程，信号处理程序，线程和Java 进程
2. 并发流
- 并发流 (concurrent flow) : 一个逻辑流的执行在时间上与另一个流重叠
- 并行流 (parallel flow) : 2个流并发地运行在不同的处理器核或者计算机上

3. 私有地址空间
- 地址空间： n 位地址的机器上，地址空间是 2^n 个可能的地址的集合

4. 用户模式和内核模式
- 用户模式
- 内核模式

5. 上下文切换

二. 系统调用错误处理
=================
```C
void unix_error(char *msg)
{
	fprintf(stderr, "%s: %s\n", msg, strerror(errno));
	exit(0);
}
```
三. 进程控制
==========
1. 创建和终止进程
- 运行
- 停止
- 终止
2. 回收子进程

四. 信号
=======
Linux 信号 软件异常：允许进程中断其他进程
Linux 系统上支持 30 种不同类型的信号：
```
$ man 7 signal 
```
1. 信号术语
- 发送信号 ： 内核通过更新目的进程上下文的某个状态， 发送（递送）一个信号给目的进程。有2个原因：
	1） 内核检测到一个系统时间，比如被0除错误或者子进程终止
	2） 一个进程调用来 kill 函数， 显示地要求内核发送一个信号给目的进程。一个进程可以发信号给自己
- 接收信号 ： 当目的进程被内核强迫以某种方式对信号的发送做出反应时，目的进程就接收来信号。进程可以忽略这个信号，
终止或者通过执行一个称为信号处理程序(signal handler)的用户层函数捕获这个信号
	一种类型至多只有一个待处理的信号，如果多次发送同一个类型的信号不会排队等待，会被简单的丢弃。









































